<!DOCTYPE HTML>
<html lang="en">
  <head>
  <meta charset="UTF-8">
  <title>USGS Map As A Knowledge Base Map</title>

  <!-- top menu bar css + js -->
  <link rel="stylesheet" href="cssmenu_updated/menu_styles.css" />
  <script src="jquery/jquery-latest.min.js" type="text/javascript"></script>
  <script src="cssmenu_updated/menu_script.js"></script>

  <!-- leaflet map css -->
  <link rel="stylesheet" href="leaflet/leaflet.css" />
  <link rel="stylesheet" href="leaflet-cluster/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="leaflet-cluster/dist/MarkerCluster.Default.css" />
  <style>
	#mapid { height: 100%; }

	body, html {
  	  height: 100%;
	}
  </style>

  <!-- leaflet map + wfs-t plugin js -->
  <script src="leaflet/leaflet.js"></script>
  <script src="leaflet-wfts/leaflet-wfst.min.js"></script>
  <script src="leaflet-cluster/dist/leaflet.markercluster.js"></script>
  
  <!-- leaflet Mouse Position plugin  -->
  <link rel="stylesheet" href="leaflet-coord/L.Control.MousePosition.css" />
  <script src="leaflet-coord/L.Control.MousePosition.js"></script>
  
  <!-- leaflet ZoomBox plugin  -->
  <link rel="stylesheet" href="leaflet-zoom/L.Control.ZoomBox.css" />
  <script src="leaflet-zoom/L.Control.ZoomBox.min.js"></script>
  
  <!-- afd js  -->
  <script src="afd/afd-wfs.js"></script>
  <script src="afd/afd-rdf.js"></script>
  
  <!-- makb js -->
  <script src="makb/makb-rdf.js"></script>
  <script src="makb/makb-qb.js"></script>
  
  <!-- dbpedia js-->
  <script src="ld/dbpedia.js"></script>
  <!-- afd tabs (jquery-ui) -->
  <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script>
  $( function() {
    $( "#afd-tabs" ).tabs({
      beforeLoad: function( event, ui ) {
        ui.jqXHR.fail(function() {
          ui.panel.html("Couldn't load data into this tab.");
        });
      }
    });
  } );
  </script>
  

</head>
<body>

  <!-- top menu -->
  <div id='cssmenu' style="z-index: 2">
	<ul>
		</li>
			<li class='active'><a href='#' onClick="createQueryTab();">Custom Query Builder</a></li>
		</li>
	    <li class='active'><a href='#'>Functions</a>
			<ul>
				<li><a href='#' onClick='clearMap();'>Clear Map</a></li>
				<li><a href='#' onClick='clearMarkers();'>Clear Markers</a></li>
				<li><a href='#' onClick='clearTabs();'>Clear Tabs</a></li>
			</ul>
		</li>
		<li class='active'><a href='#'>Layers</a>
			<ul>
				<li><a href='#' onClick="makePointQuery('GNIS');">USGS GNIS - DC</a></li>
				<li><a href='#' onClick="makePointQuery('Structures');">USGS Structures - DC</a></li>
				<li><a href='#' onClick="makePointQuery('Geonames');">GeoNames.org - DC</a></li>
				<li><a href='#' onClick="makeLineQuery('Trails');">Trails - DC</a></li>
				<li><a href='#' onClick="makePolygonQuery('County');">CountyOrEqual - DC</a></li>
				<li><a href='#' onClick="makePolygonQuery('State');">StateOrEqual - DC</a></li>
				<li><a href='#' onClick="makeMultiPolygonQuery();">PADUS - DC</a></li>
				<li><a href='#' onClick="makeLineQuery('NHDFlowline');">NHD Flowline - DC</a></li>
				<li><a href='#' onClick="makePolygonQuery('NHDWaterbody');">NHD Waterbody - DC</a></li>
			</ul>
		</li>
		<li class='active'><a href='#'>Markers</a>
			<ul>
				<li><a href='#'>Add Marker</li></a>
				<!-- Populate with user desired locations -->
			</ul>
		</li>
		<li class='active'><a href='#'>Set View</a>
			<ul>
				<li><a href='#' onClick="zoomMapToLocation('Initial');">Reset to Initial</a></li>
				<li><a href='#' onClick="zoomMapToLocation('US Capitol');">US Capitol</a></li>
				<li><a href='#' onClick="zoomMapToLocation('Reflecting Pool');">Reflecting Pool</a></li>
				<li><a href='#' onClick="zoomMapToLocation('McMillan Reservoir');">McMillan Reservoir</a></li>
				<li><a href='#' onClick="zoomMapToLocation('DC FEMS Engine 19');">DC FEMS Engine 19</a></li>
			</ul>
		</li>
	</ul>
	
  </div>

  

  <div id="maincontainer" style="width: 100%; height: 100%;">
     <!-- leaflet map -->
     <div id="mapid" style="z-index: 1; width: 70%; height: 90.55%; float: left; border-style: solid; border-width: 1px; margin-right: 3px; margin-top: 9px;"></div>
     <!-- advanced feature description tabs -->
     <div class="widget" style="height: 90.55%; font-family: Arial, Helvetica, sans-serif; <!--overflow-x: scroll; --> overflow-y: hidden; margin-top: 7px;">
		<fieldset>
        <legend>Advanced Feature Descriptions</legend>
        <div id="afd-tabs" style="z-index: 1; width: 98%; height: 50px; float: left; margin-top: 5px;">
	    <ul id="afd-tabs-list">
	       <!-- list is populated programmatically -->
	    </ul>
		</fieldset>
    </div>
	<!-- tab div content populated programmatically -->
     </div>
  </div>
  
  <!-- initialize leaflet map -->
  <script>
	var countFilter = 0;
	
	var queryTabID = "";

	var grouping = L.markerClusterGroup({
                disableClusteringAtZoom: 15,
                spiderfyOnMaxZoom: false
        });

    // Init map with open street map as base map over DC area
    var map = L.map('mapid', {zoomSnap: .25, wheelPxPerZoomLevel: 120}).setView([38.88971, -77.00894], 12);
	map.options.minZoom = 2;

    L.tileLayer('https://basemap.nationalmap.gov/arcgis/rest/services/USGSTopo/MapServer/tile/{z}/{y}/{x}', {
                maxZoom: 16,
                attribution: '<a href="https://www.doi.gov">U.S. Department of the Interior</a> | <a href="https://www.usgs.gov">U.S. Geological Survey</a> | <a href="https://www.usgs.gov/laws/policies_notices.html">Policies</a>',
                id: 'USGSTopo'
        }).addTo(map);

    // Add coordinate information
	L.control.mousePosition().addTo(map);

    // Add ZoomBox control
	var options = { position: "topleft" };
	var zoom = L.control.zoomBox(options);
	map.addControl(zoom);

	// NOTE: Subtraction of map offset doesn't seem to have an effects
    // set height of afd tabs to height of map
    $('#afd-tabs').height(
	$('#mapid').height() - /* minus map offset */ 33
    );
	
	//Function to clear the map of data
	function clearMap()
	{
		grouping.clearLayers();
	}
	
	//Function to clear all markers from map
	function clearMarkers()
	{
		return;
	}
	
	//Function to clear all current tabs
	function clearTabs(){
		$('#afd-tabs ul li').remove();
		$('#afd-tabs div').remove();
		$("#afd-tabs").tabs("refresh");
	}

	//Function to "Expand" query writing area
	function qWrite_show(){
		document.getElementById('qWritePopup').style.display = "block";
	}

	//Function to Hide query writing area
	function qWrite_hide(){
		document.getElementById('qWritePopup').style.display = "none";
	}
	
	//Function to zoom to pre-defined locations around the map
	function zoomMapToLocation(loc)
	{
		if(loc == 'Initial'){
			map.setView([38.8897547, -77.0089138], 12);
		}
		else if(loc == 'US Capitol'){
			map.setView([38.8897547, -77.0089138], 15);
		}
		else if(loc == 'Reflecting Pool'){
			map.setView([38.8893298, -77.0445652], 15);
		}
		else if(loc == 'McMillan Reservoir'){
			map.setView([38.9248438, -77.0169079], 15);
		}
		else if(loc == 'DC FEMS Engine 19'){
			map.setView([38.87161, -76.96695], 16);
		}
	}
	
	//Inserts an element after a referenced one.
	function insertAfter(el, referenceNode) {
    referenceNode.parentNode.insertBefore(el, referenceNode.nextSibling);
	}
	

	
	
	
	
  </script>
</body>
</html>